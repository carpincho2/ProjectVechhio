<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="styles.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="service.css">
    <link rel="shortcut icon" href="/logos/favicon_io/favicon.ico" type="image/x-icon">
    <title>service</title>
</head>
<body>
    <header class="header">
        <div >
           <a href="index.html"><img src="logo.png" alt="" class="logo"></a>
        </div>
        <div class="vehicles">
            <a href="vehicles.html">Vehicles</a>
        </div>
        <div class="certified">
            <a href="certified.html">Certified</a>
        </div>
        <div class="finance">
            <a href="finance.html">Finance</a>
        </div>
        <div class="service">
            <a href="service.html">Service</a>
        </div>
        <div class="aboutUs">
            <a href="aboutUs.html">About Us</a>
        </div>
        <div class="Login">
            <a href="login.html">login</a>
        </div>
        <div class="register">
            <a href="register.html">Register</a>
        </div>
    </header>
    <section class="service-container">
  <h1 class="service-title">Servicio Técnico Oficial</h1>
  <p class="service-description">
    Cuidamos tu vehículo como si fuera nuestro. Nuestro equipo especializado asegura calidad, rapidez y transparencia.
  </p>

  <div class="service-grid">
    <div class="service-card">
      <h2>🧰 Mantenimiento Preventivo</h2>
      <p>Cambio de aceite, filtros, correas, y revisión general del vehículo.</p>
    </div>
    <div class="service-card">
      <h2>🛠 Revisión Completa</h2>
      <p>Chequeo electrónico, diagnosis de fallas y ajustes generales.</p>
    </div>
    <div class="service-card">
      <h2>🛞 Frenos y Suspensión</h2>
      <p>Revisión y reemplazo de frenos, amortiguadores y alineación.</p>
    </div>
  </div>

  <div class="service-form-container">
    <h2>Solicitá tu turno</h2>
     <form class="service-form" id="serviceForm">
      <input type="text" id="fullName" placeholder="Nombre completo" required>
      <input type="email" id="email" placeholder="Correo" required>
      <input type="text" id="licensePlate" placeholder="Patente del vehículo" required>
      <select id="serviceType" required>
        <option value="" disabled selected>Selecciona tipo de servicio</option>
        <option value="Mantenimiento Preventivo">Mantenimiento Preventivo</option>
        <option value="Revisión Completa">Revisión Completa</option>
        <option value="Frenos y Suspensión">Frenos y Suspensión</option>
        <option value="Cambio de Aceite">Cambio de Aceite</option>
        <option value="Reparación General">Reparación General</option>
      </select>
      <input type="date" id="serviceDate" required>
      <textarea id="comments" placeholder="Comentarios opcionales"></textarea>
      <button type="submit">Pedir Turno</button>
    </form>
  </div>
</section>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const serviceForm = document.getElementById('serviceForm');

        serviceForm.addEventListener('submit', async (e) => {
            e.preventDefault();

            const token = localStorage.getItem('jwtToken');
            if (!token) {
                alert('Debes iniciar sesión para solicitar un servicio.');
                window.location.href = 'login.html';
                return;
            }

            const fullName = document.getElementById('fullName').value;
            const email = document.getElementById('email').value;
            const licensePlate = document.getElementById('licensePlate').value;
            const serviceType = document.getElementById('serviceType').value;
            const serviceDate = document.getElementById('serviceDate').value;
            const comments = document.getElementById('comments').value;

            try {
                const response = await fetch('/api/services', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({
                        type: serviceType,
                        date: serviceDate,
                        // status will be 'scheduled' by default in backend
                        // userId will be extracted from token in backend
                        // vehicleId is optional, not collected in this form
                        comments: comments,
                        // Assuming backend can handle additional fields like fullName, email, licensePlate
                        // If not, these should be removed or handled differently
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    alert('Servicio solicitado con éxito!');
                    serviceForm.reset();
                } else {
                    alert(`Error al solicitar servicio: ${data.error || data.message || 'Error desconocido'}`);
                }
            } catch (error) {
                console.error('Error en la solicitud de servicio:', error);
                alert('Error de conexión con el servidor.');
            }
        });
    });
</script>
</body>
</html>